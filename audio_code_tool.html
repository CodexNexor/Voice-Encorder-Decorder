<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Audio Encoder / Decoder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #050816;
      --bg-card: #0f172a;
      --accent: #6366f1;
      --accent-soft: rgba(99, 102, 241, 0.14);
      --accent-strong: rgba(99, 102, 241, 0.35);
      --text: #e5e7eb;
      --muted: #9ca3af;
      --error: #f97373;
      --success: #4ade80;
      --radius-xl: 18px;
      --shadow-soft: 0 22px 50px rgba(15, 23, 42, 0.9);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
    }

    body {
      min-height: 100vh;
      background: radial-gradient(circle at top, #1f2937 0, #020617 40%, #000 100%);
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }

    .app {
      width: 100%;
      max-width: 1100px;
      background: linear-gradient(145deg, #020617 0%, #020817 40%, #030712 100%);
      border-radius: 24px;
      padding: 24px 24px 26px;
      box-shadow:
        0 0 0 1px rgba(148, 163, 184, 0.1),
        var(--shadow-soft);
      position: relative;
      overflow: hidden;
    }

    .app::before {
      content: "";
      position: absolute;
      inset: -50%;
      background:
        radial-gradient(circle at 10% 20%, rgba(56, 189, 248, 0.18), transparent 50%),
        radial-gradient(circle at 90% 80%, rgba(129, 140, 248, 0.18), transparent 50%);
      opacity: 0.8;
      z-index: -1;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      margin-bottom: 18px;
    }

    .title-block {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    h1 {
      font-size: 1.4rem;
      font-weight: 600;
      letter-spacing: 0.03em;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    h1 span.badge {
      font-size: 0.65rem;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      padding: 3px 7px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      color: var(--muted);
      background: radial-gradient(circle at 30% 0, rgba(59, 130, 246, 0.36), transparent 55%);
    }

    .subtitle {
      font-size: 0.82rem;
      color: var(--muted);
    }

    .pill {
      font-size: 0.72rem;
      text-transform: uppercase;
      padding: 4px 9px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      display: inline-flex;
      align-items: center;
      gap: 4px;
      color: var(--muted);
      white-space: nowrap;
    }

    .pill-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: radial-gradient(circle, #22c55e 0%, #15803d 60%, transparent 100%);
      box-shadow: 0 0 12px rgba(34, 197, 94, 0.8);
    }

    .layout {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 18px;
    }

    @media (max-width: 900px) {
      .layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .card {
      background: radial-gradient(circle at top left, #0b1220 0, #020617 55%);
      border-radius: var(--radius-xl);
      border: 1px solid rgba(148, 163, 184, 0.4);
      padding: 16px 16px 14px;
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(
        140deg,
        rgba(148, 163, 184, 0.26) 0%,
        transparent 40%
      );
      mix-blend-mode: soft-light;
      opacity: 0.7;
      pointer-events: none;
    }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
      gap: 6px;
    }

    .card-title {
      font-size: 0.92rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .chip {
      font-size: 0.68rem;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.4);
      color: var(--muted);
    }

    .hint {
      font-size: 0.72rem;
      color: var(--muted);
      margin-bottom: 10px;
    }

    .field {
      margin-bottom: 10px;
    }

    label {
      font-size: 0.8rem;
      color: #cbd5f5;
      margin-bottom: 4px;
      display: block;
    }

    input[type="file"] {
      font-size: 0.78rem;
      color: var(--muted);
    }

    .file-input-wrapper {
      position: relative;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 7px 10px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.5);
      cursor: pointer;
    }

    .file-input-wrapper span.icon {
      font-size: 0.9rem;
      opacity: 0.9;
    }

    .file-input-wrapper span.text {
      font-size: 0.78rem;
      color: var(--muted);
    }

    .file-input-wrapper input[type="file"] {
      position: absolute;
      inset: 0;
      opacity: 0;
      cursor: pointer;
    }

    textarea,
    input[type="text"] {
      width: 100%;
      border-radius: 12px;
      border: 1px solid rgba(148, 163, 184, 0.55);
      background: radial-gradient(circle at top, #020617 0, #020617 35%, #020617 100%);
      padding: 8px 9px;
      font-size: 0.78rem;
      color: var(--text);
      outline: none;
      resize: vertical;
      min-height: 110px;
    }

    textarea:focus,
    input[type="text"]:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(129, 140, 248, 0.7);
    }

    input[type="text"] {
      min-height: 0;
      height: 34px;
    }

    .controls {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-top: 8px;
      flex-wrap: wrap;
    }

    .btn-row {
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
    }

    button {
      border-radius: 999px;
      border: none;
      padding: 6px 12px;
      font-size: 0.78rem;
      font-weight: 500;
      letter-spacing: 0.02em;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      background: radial-gradient(circle at top, var(--accent) 0%, #4f46e5 50%, #312e81 100%);
      color: #e5e7eb;
      box-shadow:
        0 10px 25px rgba(79, 70, 229, 0.45),
        0 0 0 1px rgba(129, 140, 248, 0.7);
      transition:
        transform 0.08s ease-out,
        box-shadow 0.08s ease-out,
        filter 0.08s ease-out;
      white-space: nowrap;
    }

    button.secondary {
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.95) 0, #020617 50%, #000 100%);
      box-shadow: 0 0 0 1px rgba(148, 163, 184, 0.7);
      color: var(--muted);
    }

    button:hover {
      transform: translateY(-1px);
      filter: brightness(1.05);
      box-shadow:
        0 14px 30px rgba(79, 70, 229, 0.6),
        0 0 0 1px rgba(191, 219, 254, 0.7);
    }

    button.secondary:hover {
      box-shadow:
        0 10px 22px rgba(15, 23, 42, 0.9),
        0 0 0 1px rgba(209, 213, 219, 0.85);
    }

    .status {
      font-size: 0.74rem;
      color: var(--muted);
    }

    .status.error {
      color: var(--error);
    }

    .status.success {
      color: var(--success);
    }

    .status.loading::before {
      content: "";
      display: inline-block;
      width: 9px;
      height: 9px;
      border-radius: 999px;
      border: 2px solid rgba(148, 163, 184, 0.5);
      border-top-color: var(--accent);
      margin-right: 6px;
      animation: spin 0.6s linear infinite;
      vertical-align: -1px;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .output-meta {
      font-size: 0.72rem;
      color: var(--muted);
      margin-top: 4px;
    }

    .download-link {
      display: none;
      font-size: 0.78rem;
      margin-top: 6px;
      text-decoration: none;
      padding: 5px 10px;
      border-radius: 999px;
      border: 1px solid rgba(129, 140, 248, 0.7);
      background: radial-gradient(circle at top, var(--accent-soft) 0, transparent 70%);
      color: #c7d2fe;
    }

    audio {
      width: 100%;
      display: none;
      margin-top: 8px;
      filter: drop-shadow(0 8px 18px rgba(15, 23, 42, 0.95));
    }

    .footer-note {
      margin-top: 14px;
      font-size: 0.7rem;
      color: var(--muted);
      display: flex;
      justify-content: space-between;
      gap: 6px;
      flex-wrap: wrap;
    }

    .footer-note span {
      opacity: 0.9;
    }

    .mono {
      font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco,
        Consolas, "Liberation Mono", "Courier New", monospace;
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="title-block">
        <h1>
          Audio Code Lab
          <span class="badge">Base64 encoder / decoder</span>
        </h1>
        <p class="subtitle">
          Turn any audio file into a sharable secret code &amp; reconstruct it back into sound ‚Äî all in your browser.
        </p>
      </div>
      <div class="pill">
        <span class="pill-dot"></span>
        <span>Offline ¬∑ Local only</span>
      </div>
    </header>

    <div class="layout">
      <!-- ENCODER -->
      <section class="card">
        <div class="card-header">
          <div class="card-title">
            üîê Encoder
            <span class="chip mono">audio ‚Üí code</span>
          </div>
        </div>
        <p class="hint">
          Choose an audio file (<span class="mono">.mp3</span>, <span class="mono">.wav</span>, etc.). It will be converted
          to a base64 string that you can copy/share.
        </p>

        <div class="field" style="margin-top: 10px;">
          <label>Audio file</label>
          <div class="file-input-wrapper">
            <span class="icon">üéµ</span>
            <span class="text" id="fileLabel">Choose file‚Ä¶</span>
            <input type="file" id="audioFile" accept="audio/*" />
          </div>
        </div>

        <div class="field">
          <label>Generated secret code</label>
          <textarea id="codeOutput" placeholder="Your base64 code will appear here‚Ä¶" readonly></textarea>
          <div class="output-meta mono" id="fileInfo"></div>
        </div>

        <div class="controls">
          <div class="btn-row">
            <button id="encodeBtn">
              ‚ö° Generate code
            </button>
            <button id="copyCodeBtn" class="secondary">
              üìã Copy code
            </button>
          </div>
          <span class="status" id="encodeStatus">Waiting for file‚Ä¶</span>
        </div>
      </section>

      <!-- DECODER -->
      <section class="card">
        <div class="card-header">
          <div class="card-title">
            üîä Decoder
            <span class="chip mono">code ‚Üí audio</span>
          </div>
        </div>
        <p class="hint">
          Paste a base64 secret code below and rebuild the original audio. You can download or play it directly.
        </p>

        <div class="field" style="margin-top: 10px;">
          <label>Secret code</label>
          <textarea id="codeInput" placeholder="Paste your base64 code here‚Ä¶"></textarea>
        </div>

        <div class="field">
          <label>Output audio filename</label>
          <input
            type="text"
            id="outputName"
            class="mono"
            placeholder="recovered_audio.mp3"
          />
        </div>

        <div class="controls">
          <div class="btn-row">
            <button id="decodeBtn">
              üéß Rebuild audio
            </button>
            <a id="downloadLink" class="download-link" href="#">‚¨á Download audio</a>
          </div>
          <span class="status" id="decodeStatus">Paste a code to begin‚Ä¶</span>
        </div>

        <audio id="audioPlayer" controls></audio>
      </section>
    </div>

    <div class="footer-note">
      <span>All processing happens locally in your browser ‚Äî no files are uploaded.</span>
      <span class="mono">Encoding: raw bytes ‚áÑ base64 string</span>
    </div>
  </div>

  <script>
    // ---------- Helpers ----------
    function arrayBufferToBase64(buffer) {
      const bytes = new Uint8Array(buffer);
      let binary = "";
      const len = bytes.byteLength;
      for (let i = 0; i < len; i++) {
        binary += String.fromCharCode(bytes[i]);
      }
      return btoa(binary);
    }

    function base64ToUint8Array(base64) {
      const binary = atob(base64);
      const len = binary.length;
      const bytes = new Uint8Array(len);
      for (let i = 0; i < len; i++) {
        bytes[i] = binary.charCodeAt(i);
      }
      return bytes;
    }

    function formatBytes(bytes) {
      if (bytes === 0) return "0 B";
      const k = 1024;
      const units = ["B", "KB", "MB", "GB"];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      const size = (bytes / Math.pow(k, i)).toFixed(2);
      return `${size} ${units[i]}`;
    }

    // ---------- DOM elements ----------
    const audioFileInput = document.getElementById("audioFile");
    const fileLabel = document.getElementById("fileLabel");
    const fileInfo = document.getElementById("fileInfo");
    const codeOutput = document.getElementById("codeOutput");
    const encodeBtn = document.getElementById("encodeBtn");
    const copyCodeBtn = document.getElementById("copyCodeBtn");
    const encodeStatus = document.getElementById("encodeStatus");

    const codeInput = document.getElementById("codeInput");
    const outputName = document.getElementById("outputName");
    const decodeBtn = document.getElementById("decodeBtn");
    const decodeStatus = document.getElementById("decodeStatus");
    const downloadLink = document.getElementById("downloadLink");
    const audioPlayer = document.getElementById("audioPlayer");

    // ---------- ENCODER ----------
    audioFileInput.addEventListener("change", () => {
      const file = audioFileInput.files[0];
      if (!file) {
        fileLabel.textContent = "Choose file‚Ä¶";
        fileInfo.textContent = "";
        encodeStatus.textContent = "Waiting for file‚Ä¶";
        encodeStatus.className = "status";
        return;
      }
      fileLabel.textContent = file.name;
      fileInfo.textContent = `${file.name} ¬∑ ${formatBytes(file.size)}`;
      encodeStatus.textContent = "Ready to generate code.";
      encodeStatus.className = "status";
    });

    encodeBtn.addEventListener("click", () => {
      const file = audioFileInput.files[0];
      if (!file) {
        encodeStatus.textContent = "Please choose an audio file first.";
        encodeStatus.className = "status error";
        return;
      }

      encodeStatus.textContent = "Encoding file to base64‚Ä¶";
      encodeStatus.className = "status loading";

      const reader = new FileReader();
      reader.onload = function (e) {
        try {
          const base64 = arrayBufferToBase64(e.target.result);
          codeOutput.value = base64;
          encodeStatus.textContent = "Code generated successfully.";
          encodeStatus.className = "status success";
        } catch (err) {
          console.error(err);
          encodeStatus.textContent = "Failed to encode file.";
          encodeStatus.className = "status error";
        }
      };
      reader.onerror = function () {
        encodeStatus.textContent = "Error reading file.";
        encodeStatus.className = "status error";
      };
      reader.readAsArrayBuffer(file);
    });

    copyCodeBtn.addEventListener("click", async () => {
      const text = codeOutput.value.trim();
      if (!text) {
        encodeStatus.textContent = "Nothing to copy ‚Äì generate a code first.";
        encodeStatus.className = "status error";
        return;
      }
      try {
        await navigator.clipboard.writeText(text);
        encodeStatus.textContent = "Code copied to clipboard.";
        encodeStatus.className = "status success";
      } catch {
        encodeStatus.textContent =
          "Could not access clipboard. Please copy manually.";
        encodeStatus.className = "status error";
      }
    });

    // ---------- DECODER ----------
    decodeBtn.addEventListener("click", () => {
      let base64 = codeInput.value.trim();
      if (!base64) {
        decodeStatus.textContent = "Paste a base64 code first.";
        decodeStatus.className = "status error";
        return;
      }

      // Remove whitespace/newlines
      base64 = base64.replace(/\s+/g, "");

      const name = (outputName.value || "recovered_audio.mp3").trim();
      decodeStatus.textContent = "Decoding code into audio‚Ä¶";
      decodeStatus.className = "status loading";

      try {
        const bytes = base64ToUint8Array(base64);
        // Default type: audio/mpeg (works fine for most players even if original was wav)
        const blob = new Blob([bytes], { type: "audio/mpeg" });
        const url = URL.createObjectURL(blob);

        downloadLink.href = url;
        downloadLink.download = name;
        downloadLink.style.display = "inline-flex";
        downloadLink.textContent = `‚¨á Download ${name}`;

        audioPlayer.src = url;
        audioPlayer.style.display = "block";

        decodeStatus.textContent = "Audio reconstructed successfully.";
        decodeStatus.className = "status success";
      } catch (err) {
        console.error(err);
        decodeStatus.textContent =
          "Failed to decode. Check that the code is valid base64.";
        decodeStatus.className = "status error";
        downloadLink.style.display = "none";
        audioPlayer.style.display = "none";
      }
    });
  </script>
</body>
</html>
